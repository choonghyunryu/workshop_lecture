<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>애플리케이션 서버 구축을 위한 R 워크샾: R 패키지 개발하기</title>

  <meta property="description" itemprop="description" content="몇 가지 Open API를 이용한 데이터 수집 기능을 구현한 R 패키지를 만들어 봅니다."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-02-05"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-02-05"/>
  <meta name="article:author" content="유충현"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="애플리케이션 서버 구축을 위한 R 워크샾: R 패키지 개발하기"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="몇 가지 Open API를 이용한 데이터 수집 기능을 구현한 R 패키지를 만들어 봅니다."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="애플리케이션 서버 구축을 위한 R 워크샾"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="애플리케이션 서버 구축을 위한 R 워크샾: R 패키지 개발하기"/>
  <meta property="twitter:description" content="몇 가지 Open API를 이용한 데이터 수집 기능을 구현한 R 패키지를 만들어 봅니다."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="애플리케이션 서버 구축을 위한 R 워크샾: R 패키지 개발하기"/>
  <meta name="citation_fulltext_html_url" content="https://choonghyunryu.github.io/workshop_lecture/develop_package"/>
  <meta name="citation_online_date" content="2022/02/05"/>
  <meta name="citation_publication_date" content="2022/02/05"/>
  <meta name="citation_author" content="유충현"/>
  <meta name="citation_author_institution" content="한화생명"/>
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","citation_url","date","output"]}},"value":[{"type":"character","attributes":{},"value":["R 패키지 개발하기"]},{"type":"character","attributes":{},"value":["몇 가지 Open API를 이용한 데이터 수집 기능을 구현한 R 패키지를 만들어 봅니다.  \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation"]}},"value":[{"type":"character","attributes":{},"value":["유충현"]},{"type":"character","attributes":{},"value":["https://choonghyunryu.github.io"]},{"type":"character","attributes":{},"value":["한화생명"]}]}]},{"type":"character","attributes":{},"value":["https://choonghyunryu.github.io/workshop_lecture/develop_package"]},{"type":"character","attributes":{},"value":["2022-02-05"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */

  :root {
    --custom-grey60: rgb(102, 102, 102);
    --custom-grey20: rgb(204, 204, 204);
    --custom-grey10: rgb(230, 230, 230);
    --custom-blue: rgb(0, 114, 188);
    --custom-lightblue: rgb(204, 227, 242);
    --custom-orange: rgb(255, 127, 42); 
    --custom-lightorange: rgb(255, 204, 170); 
  }

  @font-face {
   font-family: 'NanumSquare';
   font-weight: 400;
   src: url(NanumSquare/NanumSquareR.eot);
   src: url(NanumSquare/NanumSquareR.eot?#iefix) format('embedded-opentype'),
        url(NanumSquare/NanumSquareR.woff) format('woff'),
        url(NanumSquare/NanumSquareR.ttf) format('truetype');
  }
  @font-face {
   font-family: 'NanumSquare';
   font-weight: 700;
   src: url(NanumSquare/NanumSquareB.eot);
   src: url(NanumSquare/NanumSquareB.eot?#iefix) format('embedded-opentype'),
        url(NanumSquare/NanumSquareB.woff) format('woff'),
        url(NanumSquare/NanumSquareB.ttf) format('truetype');
  }
  @font-face {
   font-family: 'NanumSquare';
   font-weight: 800;
   src: url(NanumSquare/NanumSquareEB.eot);
   src: url(NanumSquare/NanumSquareEB.eot?#iefix) format('embedded-opentype'),
        url(NanumSquare/NanumSquareEB.woff) format('woff'),
        url(NanumSquare/NanumSquareEB.ttf) format('truetype');
  }
  @font-face {
   font-family: 'NanumSquare';
   font-weight: 300;
   src: url(NanumSquare/NanumSquareL.eot);
   src: url(NanumSquare/NanumSquareL.eot?#iefix) format('embedded-opentype'),
        url(NanumSquare/NanumSquareL.woff) format('woff'),
        url(NanumSquare/NanumSquareL.ttf) format('truetype');
  }

  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       var(--custom-blue);
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       var(--custom-blue);
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */

  .preface {
    font-size: 11pt;
    background-color: var(--custom-lightblue);
    margin-top: 2em;
    margin-bottom: 0.5em;  
    padding: 1.5em;
    padding-top: 1em;
    border-color: DodgerBlue;
  }

  h1 {
    font-size: 30px !important;  
    color: var(--custom-blue) !important;
    font-family: NanumSquare !important;
    margin-top: 15px !important;
    padding-top: 15px !important;  
    margin-bottom: 15px !important;
    font-weight: bold;
  }

  h2 {
    font-size: 25px !important;  
    color: var(--custom-blue) !important;  
    font-family: NanumSquare !important;  
    padding-top: 15px !important;  
    margin-top: 15px !important;
    padding-bottom: 10px !important;  
    margin-bottom: 10px !important;    
    font-weight: bold;
  }

  h3 {
    font-size: 20px !important;  
    color: var(--custom-blue) !important;  
    font-family: NanumSquare !important;  
    margin-top: 10px !important;
    margin-bottom: 10px !important; 
    padding-top: 10px !important;
    padding-bottom: 10px !important;   
    font-weight: bold;
  }

  d-byline h3 {
    font-size: 0.6rem !important;   
    font-weight: 400 !important;   
    color: rgba(0, 0, 0, 0.5) !important;   
    margin: 0 !important;   
  }
      
  d-byline {
    contain: content;
    overflow: hidden;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    font-size: 0.8rem;
    line-height: 1.8em;
    padding: 1.5rem 0;
    min-height: 1.8em;
  } 

  .bg-blue,
  .bg-orange,
  .bg-grey {
    padding: 1.6em;
    margin-top: 1.0em;
    margin-bottom: 1.0em;
  }
  .bg-blue {
    background-color: var(--custom-lightblue);
  }
  .bg-orange {
    background-color: var(--custom-lightorange);
  }
  .bg-grey {
    background-color: var(--custom-grey20);
  }
  .bg-blue > *:last-child,
  .bg-orange > *:last-child,
  .bg-grey > *:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
  }

  .panelset {
    --panel-tab-foreground: currentColor !important;
    --panel-tab-active-foreground: var(--custom-blue) !important;
    --panel-tab-active-background: var(--custom-lightblue) !important;  
    --panel-tab-hover-foreground: var(--custom-blue) !important;
    --panel-tabs-border-bottom: #ddd !important;
    --panel-tab-inactive-opacity: 0.5 !important;
  }

  .panel {
    margin-bottom: 10px;
    margin-top: 10px;
  }
  </style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
  <link href="site_libs/panelset-0.2.5.9000/panelset.css" rel="stylesheet" />
  <script src="site_libs/panelset-0.2.5.9000/panelset.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"R 패키지 개발하기","description":"몇 가지 Open API를 이용한 데이터 수집 기능을 구현한 R 패키지를 만들어 봅니다.","authors":[{"author":"유충현","authorURL":"https://choonghyunryu.github.io","affiliation":"한화생명","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-02-05T00:00:00.000+00:00","citationText":"유충현, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">애플리케이션 서버 구축을 위한 R 워크샾</a>
</div>
<div class="nav-right">
<a href="index.html">R 워크샾 개요</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
R Markdown hands-on
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="rmarkdown.html">R Markdown의 이해</a>
<hr/>
<a href="RStudio.html">첫 R 마크다운 문서 만들기</a>
<a href="chunk_knitr.html">청크 옵션 이해하기</a>
<a href="rmarkdown_yaml.html">YAML 이해하기</a>
<a href="understand_markdown.html">마크다운 태그 이해하기</a>
<hr/>
<a href="use_distill.html">distill 패키지의 활용</a>
<hr/>
<a href="cheatsheets.html">Cheatsheets</a>
<hr/>
<a href="rmarkdown_resources.html">Resources</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
R Package hands-on
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="open_api.html">네이버 오픈 API 데이터 수집</a>
<a href="apt_api.html">공공데이터포털 오픈 API 데이터 수집</a>
<hr/>
<a href="coding_style.html">R 코딩 스타일 가이드</a>
<a href="develop_package.html">R 패키지 개발하기</a>
<a href="submit_package.html">Submit R package to CRAN</a>
<hr/>
<a href="package_resources.html">Resources</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Shiny Hands-on
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="introduce_shiny.html">Shiny 아키텍처 이해</a>
<a href="userinterface.html">사용자 인터페이스 만들기</a>
<a href="control-widget.html">위젯 추가하기</a>
<a href="reactivity.html">반응 출력</a>
<hr/>
<a href="news_app.html">네이버 뉴스 검색 애플리케이션</a>
<hr/>
<a href="shiny_resources.html">Resources</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
docker Hands-on
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="install_docker_image.html">docker 이미지 설치하기</a>
<a href="custom_docker.html">docker 컨테이너 환경 설정하기</a>
<a href="custom_image.html">docker 이미지 만들기</a>
<hr/>
<a href="run_batch.html">배치 처리하기</a>
<hr/>
<a href="docker_resources.html">Resources</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>R 패키지 개발하기</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>몇 가지 Open API를 이용한 데이터 수집 기능을 구현한 R 패키지를 만들어 봅니다.</p></p>
</div>

<div class="d-byline">
  유충현 <a href="https://choonghyunryu.github.io" class="uri">https://choonghyunryu.github.io</a> (한화생명)
  
<br/>2022-02-05
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#r-패키지-시나리오">R 패키지 시나리오</a></li>
<li><a href="#r-패키지의-구성">R 패키지의 구성</a>
<ul>
<li><a href="#패키지-구성-파일">패키지 구성 파일</a></li>
<li><a href="#파일이름-명명규칙">파일이름 명명규칙</a></li>
</ul></li>
<li><a href="#r-패키지-골격-만들기">R 패키지 골격 만들기</a></li>
<li><a href="#r-패키지-골격-살펴보기">R 패키지 골격 살펴보기</a></li>
<li><a href="#r-패키지-개발하기">R 패키지 개발하기</a>
<ul>
<li><a href="#description-파일-수정하기">DESCRIPTION 파일 수정하기</a></li>
<li><a href="#소스파일-만들기">소스파일 만들기</a></li>
</ul></li>
<li><a href="#패키지-관련-파일의-자동-생성">패키지 관련 파일의 자동 생성</a>
<ul>
<li><a href="#roxygen2">roxygen2</a></li>
<li><a href="#roxygen2-태그">roxygen2 태그</a></li>
<li><a href="#roxygen2-태그-기반-자동-생성">roxygen2 태그 기반 자동 생성</a></li>
</ul></li>
<li><a href="#r-데이터-생성">R 데이터 생성</a>
<ul>
<li><a href="#r-데이터-파일-생성">R 데이터 파일 생성</a></li>
<li><a href="#r-데이터-도움말-파일-생성">R 데이터 도움말 파일 생성</a></li>
</ul></li>
<li><a href="#vignette-작성하기">vignette 작성하기</a>
<ul>
<li><a href="#vignette-골격-생성하기">vignette 골격 생성하기</a></li>
<li><a href="#vignette-작성하기-1">vignette 작성하기</a></li>
<li><a href="#vignette-빌드하기">vignette 빌드하기</a></li>
</ul></li>
<li><a href="#koscrap-패키지-설치하기">koscrap 패키지 설치하기</a>
<ul>
<li><a href="#r-패키지-설치하기">R 패키지 설치하기</a></li>
</ul></li>
<li><a href="#koscrap-패키지-사용하기">koscrap 패키지 사용하기</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="img/rpackage.jpeg" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="preface">
<h4>들어가기</h4>
패키지, 그 범접할 수 없는 아우라!!!
<br/>
그러나 사실 어렵지 않게 만들 수 있습니다.
<br/>
시도를 해 보지 않아서 어렵게 느낄뿐 한번 만들고 보면, 이내 두번째 패키지를 만들고 있을 겁니다.
</div>
</div>
<h2 id="r-패키지-시나리오">R 패키지 시나리오</h2>
<p>앞에서 네이버 오픈 API를 이용해서 뉴스를 검색하는 함수와 공공데이터포털의 오픈 API를 이용해서 아파트 실거래 상세 정보를 조회하는 함수를 만들어 보았니다.</p>
<p>이제 이들 함수를 포함한 R 패키지를 만들어 보려 합니다. 다음의 내용을 담을 계획입니다.</p>
<ul>
<li>함수
<ul>
<li>네이버 오픈 API를 이용한, 뉴스 검색 함수</li>
<li>공공데이터포털의 오픈 API를 이용한, 아파트 실거래 상세 정보 조회 함수</li>
</ul></li>
<li>데이터
<ul>
<li>법정동 코드 데이터</li>
</ul></li>
<li>소품(Vignettes)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>
<ul>
<li>두 함수를 사용하는 방법을 소개한 비네트</li>
</ul></li>
</ul>
<h2 id="r-패키지의-구성">R 패키지의 구성</h2>
<h3 id="패키지-구성-파일">패키지 구성 파일</h3>
<h4 id="description">DESCRIPTION</h4>
<p>패키지의 기본적인 정보를 담고 있는 메타 파일로 패키지의 버전, 저자, 종속성 등이 담겨 있습니다. CRAN의 R 패키지 페이지에서는 패키지의 여러 정보를 제공하는데, 대부분이 DESCRIPTION의 정보로 표현합니다.</p>
<h4 id="namespace">NAMESPACE</h4>
<p>개발하는 패키지가 참조하는 다른 패키지의 객체(함수나 메소드 등), 개발하는 패키지가 제공하는 객체를 네임스페이스에 등록하기 위한 정보를 담습니다.</p>
<h4 id="소스">소스</h4>
<p><code>R</code> 디렉토리에 프로그램 소스 파일을 담는다. *.R 형식으로 이름을 정의합니다.</p>
<h4 id="도움말">도움말</h4>
<p><code>man</code> 디렉토리에 데이터나 함수, 메소드에 대한 도움말 파일을 담는다. *.Rd 형식으로 이름을 정의합니다.</p>
<h4 id="소품vignettes">소품(vignettes)</h4>
<p><code>vignettes</code> 디렉토리에 도움말 보다 좀 더 친절한 패키지 사용 방법을 소개하는 소품 파일을 담습니다. R 마크다운 편집 파일로 *.Rmd 형식으로 이름을 정의합니다.</p>
<h4 id="데이터">데이터</h4>
<p><code>data</code> 디렉토리에 R 데이터 파일을 담습니다. R 데이터 파일로 *.rda 형식으로 이름을 정의합니다.</p>
<h4 id="기타-제공-파일">기타 제공 파일</h4>
<p><code>inst</code> 디렉토리에 패키지를 구성하는 표준 파일이 아니지만 패키지에 제공할 파일을 넣을 수 있습니다.</p>
<h3 id="파일이름-명명규칙">파일이름 명명규칙</h3>
<p><code>DESCRIPTION</code>, <code>NAMESPACE</code> 파일 이름은 변경이 불가능합니다. 소스파일과 소품 파일은 이름으로도 그 기능을 유추할 수 있도록 간결하면서 명확한 이름을 만들어야 합니다. 도움말 파일의 이름은 도움말을 제공하는 함수 혹은 메소드, 데이터 이름으로 정합니다.</p>
<p><strong>파일 이름은 절대로 non-ASCII 문자를 포함하면 안됩니다.</strong></p>
<h2 id="r-패키지-골격-만들기">R 패키지 골격 만들기</h2>
<p>RStudio의 기능을 이용하면 R 패키지의 골격을 쉽게 만들 수 있습니다.</p>
<p>패키지의 이름을 <strong>koscrap</strong>이라고 미리 정합니다. <strong>“Korean Scraping”</strong>을 연상하여 이름을 정했습니다.</p>
<p>File &gt; New Project… 메뉴를 선택하면, 다음과 같은 다이얼로그 창이 뜹니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:new-project"></span>
<img src="img/new_project.png" alt="New Project Wizard 화면" width="40%" />
<p class="caption">
Figure 1: New Project Wizard 화면
</p>
</div>
</div>
<p>새로운 디렉토리에 패키지를 만들 것이므로 첫번째, <strong>New Directory를 선택</strong>합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:select-rpackage"></span>
<img src="img/select_rpackage.png" alt="R Package 선택 화면" width="40%" />
<p class="caption">
Figure 2: R Package 선택 화면
</p>
</div>
</div>
<p>R 패키지 프로젝트를 만들 것이므로 두번째, <strong>R Package를 선택</strong>합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:desc-rpackage"></span>
<img src="img/desc_project.png" alt="R Package 정의 화면" width="40%" />
<p class="caption">
Figure 3: R Package 정의 화면
</p>
</div>
</div>
<p>패키지 이름에 “koscrap”을 기입하고, 패키지를 설치할 디렉토리도 선정합니다. 그리고 “Open in new session”의 체크박스를 선택합니다. 이 체크 박스는 패키지가 만들어지면 RStudio의 새로운 세션에서 해당 패키지 프로젝트를 열어 줍니다.</p>
<p>“Create Project” 버튼을 누르면 RStudio의 새로운 세션이 다음처럼 열립니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:new-session"></span>
<img src="img/new_session.png" alt="koscrap 패키지 프로젝트 세션 화면" width="40%" />
<p class="caption">
Figure 4: koscrap 패키지 프로젝트 세션 화면
</p>
</div>
</div>
<h2 id="r-패키지-골격-살펴보기">R 패키지 골격 살펴보기</h2>
<p>만들어진 R 패키지의 골격은 다음과 같습니다</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:r-tree"></span>
<img src="img/r_tree.png" alt="koscrap 패키지 디렉토리 구조" width="40%" />
<p class="caption">
Figure 5: koscrap 패키지 디렉토리 구조
</p>
</div>
</div>
<p>hello.R이라는 R 소스 파일과 hello.Rd라는 도움말 파일이 만들어져 있습니다. 이들 파일의 내용을 살펴보겠습니다.</p>
<div class="panelset">
<section id="description-1" class="panel-name panel">
<h3 class="panel-name">DESCRIPTION</h3>
<pre><code>Package: koscrap
Type: Package
Title: What the Package Does (Title Case)
Version: 0.1.0
Author: Who wrote it
Maintainer: The package maintainer &lt;yourself@somewhere.net&gt;
Description: More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.
License: What license is it under?
Encoding: UTF-8
LazyData: true</code></pre>
</section>
<section id="namespace-1" class="panel-name panel">
<h3 class="panel-name">NAMESPACE</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>exportPattern</span><span class='op'>(</span><span class='st'>"^[[:alpha:]]+"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</section>
<section id="hello.r" class="panel-name panel">
<h3 class="panel-name">hello.R</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Hello, world!</span>
<span class='co'>#</span>
<span class='co'># This is an example function named 'hello' </span>
<span class='co'># which prints 'Hello, world!'.</span>
<span class='co'>#</span>
<span class='co'># You can learn more about package authoring with RStudio at:</span>
<span class='co'>#</span>
<span class='co'>#   http://r-pkgs.had.co.nz/</span>
<span class='co'>#</span>
<span class='co'># Some useful keyboard shortcuts for package authoring:</span>
<span class='co'>#</span>
<span class='co'>#   Install Package:           'Cmd + Shift + B'</span>
<span class='co'>#   Check Package:             'Cmd + Shift + E'</span>
<span class='co'>#   Test Package:              'Cmd + Shift + T'</span>

<span class='va'>hello</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Hello, world!"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
</section>
<section id="hello.rd" class="panel-name panel">
<h3 class="panel-name">hello.Rd</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>\name{hello}</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>\alias{hello}</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>\title{Hello, World<span class="sc">!</span>}</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>\usage{</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hello</span>()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>\description{</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>Prints <span class="st">&#39;Hello, world!&#39;</span>.</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>\examples{</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hello</span>()</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</section>
</div>
<h2 id="r-패키지-개발하기">R 패키지 개발하기</h2>
<h3 id="description-파일-수정하기">DESCRIPTION 파일 수정하기</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Package<span class="sc">:</span> koscrap</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Type<span class="sc">:</span> Package </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Title<span class="sc">:</span> Scrap from Public Data Portal <span class="sc">&amp;</span> Naver </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Version<span class="sc">:</span> <span class="dv">0</span>.<span class="dv">1</span>.<span class="fl">1.9000</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>Date<span class="sc">:</span> <span class="dv">2022-01-31</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>Authors<span class="sc">@</span>R<span class="sc">:</span> <span class="fu">c</span>(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">person</span>(<span class="st">&quot;Choonghyun&quot;</span>, <span class="st">&quot;Ryu&quot;</span>,, <span class="st">&quot;choonghyun.ryu@gmail.com&quot;</span>, <span class="at">role =</span> <span class="fu">c</span>(<span class="st">&quot;aut&quot;</span>, <span class="st">&quot;cre&quot;</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>Description<span class="sc">:</span> Collect data using Open API from public data portal and scrap NAVER news article information.</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>Imports<span class="sc">:</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    dplyr,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    httr,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    XML,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    stringr,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    purrr,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    glue</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>Author<span class="sc">:</span> Choonghyun Ryu [aut, cre]</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>Maintainer<span class="sc">:</span> Choonghyun Ryu <span class="sc">&lt;</span>choonghyun.ryu<span class="sc">@</span>gmail.com<span class="sc">&gt;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>License<span class="sc">:</span> GPL<span class="dv">-2</span> <span class="sc">|</span> file LICENSE</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>Encoding<span class="sc">:</span> UTF<span class="dv">-8</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>LazyData<span class="sc">:</span> true</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>Roxygen<span class="sc">:</span> <span class="fu">list</span>(<span class="at">markdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>RoxygenNote<span class="sc">:</span> <span class="dv">7</span>.<span class="fl">1.1</span></span></code></pre></div>
</div>
<p>대표적인 태그의 의미는 다음과 같습니다.</p>
<ul>
<li>Package
<ul>
<li>패키지 이름 정의</li>
</ul></li>
<li>Title, Description
<ul>
<li>패키지 타이틀과 소개 정의<br />
</li>
</ul></li>
<li>Version
<ul>
<li>패키지 버전 정의</li>
<li>0.1.1.9000
<ul>
<li>0.1.1: 버전</li>
<li>9000: 개발버전</li>
</ul></li>
</ul></li>
<li>Imports
<ul>
<li>패키지의 종속성 정의</li>
<li>패키지의 기능을 구현하기 위해서 반드시 필요한 패키지로 해당 패키지 설치시 자동으로 설치됩니다.</li>
</ul></li>
<li>Author, Maintainer
<ul>
<li>패키지의 저자 및 유지보수 관리자</li>
</ul></li>
<li>LazyData
<ul>
<li>데이터를 사용하기 전까지 메모리에 로드되지 않을지의 여부</li>
<li>true일 경우에 사용전에는 메모리에 로드되지 않음</li>
</ul></li>
</ul>
<h3 id="소스파일-만들기">소스파일 만들기</h3>
<p>다음처럼 두개의 소스 파일을 R 디렉토리에 복사해 넣습니다.</p>
<div class="panelset">
<section id="search_naver.r" class="panel-name panel">
<h3 class="panel-name">search_naver.R</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#' 네이버 뉴스 검색</span>
<span class='co'>#'</span>
<span class='co'>#' @description 네이버 뉴스 검색 결과를 출력해주는 REST API를 호출하여, 뉴스 정보를 검색합니다.</span>
<span class='co'>#'</span>
<span class='co'>#' @details 네이버에서 발급받은 Client ID, Client Secret는 개인이 발급받은 키를 사용하며,</span>
<span class='co'>#' 유출되어서는 안됩니다.</span>
<span class='co'>#'</span>
<span class='co'>#' @param query character. 검색을 원하는 문자열</span>
<span class='co'>#' @param chunk_no integer. 검색 시작 위치로 최대 1000까지 가능</span>
<span class='co'>#' @param chunk integer. 검색 결과 출력 건수 지정 (1~100)</span>
<span class='co'>#' @param do_done logical. 한번의 호출로 모든 조회 결과를 가져오지 못할 경우,</span>
<span class='co'>#' 추가로 호출해서 모든 결과를 가져올지의 여부</span>
<span class='co'>#' @param sort character. 정렬 옵션: sim (유사도순), date (날짜순)</span>
<span class='co'>#' @param max_record integer. 최대 조회할 건수. 실제로 검색한 건수는 max_record와 정확히 일치하지 않을 수 있습니다.</span>
<span class='co'>#' chunk의 개수로 데이터를 수집하기 때문에 일반적인 경우에는 max_record보다 같거나  큰 chunk의 배수만큼 데이터를 가져옵니다.</span>
<span class='co'>#' do_done가 FALSE일 경우에는 적용되지 않습니다.</span>
<span class='co'>#' @param client_id character. 애플리케이션 등록 시 발급받은 Client ID</span>
<span class='co'>#' @param client_secret character. 애플리케이션 등록 시 발급받은 Client Secret</span>
<span class='co'>#'</span>
<span class='co'>#' @return data.frame</span>
<span class='co'>#' 변수 목록은 다음과 같음.:</span>
<span class='co'>#' \itemize{</span>
<span class='co'>#' \item title : character. 기사의 타이틀</span>
<span class='co'>#' \item originallink : character. 검색 결과 문서의 제공 언론사 하이퍼텍스트 link</span>
<span class='co'>#' \item link : character. 검색 결과 문서의 제공 네이버 하이퍼텍스트 link</span>
<span class='co'>#' \item description : character. 검색 결과 문서의 내용을 요약한 패시지 정보.</span>
<span class='co'>#' 문서 전체의 내용은 link를 따라가면 읽을 수 있음. 패시지에서 검색어와 일치하는 부분은 태그로 감싸져 있음</span>
<span class='co'>#' \item publish_date : POSIXct. 검색 결과 문서가 네이버에 제공된 시간</span>
<span class='co'>#' \item title_text : character. 타이틀에서 HTML 태크를 제거한 텍스트</span>
<span class='co'>#' \item description_text : character. 요약한 패시지 정보에서 HTML 태크를 제거한 텍스트</span>
<span class='co'>#' }</span>
<span class='co'>#'</span>
<span class='co'>#' @examples</span>
<span class='co'>#' \donttest{</span>
<span class='co'>#' # Your authorized API keys</span>
<span class='co'>#' client_id &lt;- "XXXXXXXXXXXXXXXXXXXXXXX"</span>
<span class='co'>#' client_secret &lt;- "XXXXXXXXX"</span>
<span class='co'>#'</span>
<span class='co'>#' search_list &lt;- search_naver(</span>
<span class='co'>#'   "불평등", client_id = client_id, client_secret = client_secret</span>
<span class='co'>#' )</span>
<span class='co'>#'</span>
<span class='co'>#' search_list &lt;- search_naver(</span>
<span class='co'>#'   "불평등", client_id = client_id, client_secret = client_secret,</span>
<span class='co'>#'   do_done = TRUE, max_record = 350</span>
<span class='co'>#' )</span>
<span class='co'>#'</span>
<span class='co'>#' }</span>
<span class='co'>#'</span>
<span class='co'>#' @import dplyr</span>
<span class='co'>#' @importFrom XML xmlParse getNodeSet xmlValue xmlToDataFrame</span>
<span class='co'>#' @importFrom httr GET add_headers</span>
<span class='co'>#' @importFrom purrr map_df</span>
<span class='co'>#' @importFrom glue glue</span>
<span class='co'>#' @export</span>
<span class='co'>#'</span>
<span class='va'>search_naver</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>query</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>chunk</span> <span class='op'>=</span> <span class='fl'>100</span>, <span class='va'>chunk_no</span> <span class='op'>=</span> <span class='fl'>1</span>,
                         <span class='va'>sort</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span>, <span class='st'>"sim"</span><span class='op'>)</span>, <span class='va'>do_done</span> <span class='op'>=</span> <span class='cn'>FALSE</span>,
                         <span class='va'>max_record</span> <span class='op'>=</span> <span class='fl'>1000L</span>, <span class='va'>client_id</span> <span class='op'>=</span> <span class='cn'>NULL</span>,
                         <span class='va'>client_secret</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>verbose</span> <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>query</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"검색 키워드인 query를 입력하지 않았습니다."</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>chunk</span> <span class='op'>&lt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>chunk</span> <span class='op'>&gt;</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"chunk 요청 변수값이 허용 범위(1~100)인지 확인해 보세요."</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>chunk_no</span> <span class='op'>&lt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>chunk_no</span> <span class='op'>&gt;</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"chunk_no 요청 변수값이 허용 범위(1~1000)인지 확인해 보세요."</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='va'>sort</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/match.arg.html'>match.arg</a></span><span class='op'>(</span><span class='va'>sort</span><span class='op'>)</span>

  <span class='va'>get_list</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>doc</span> <span class='op'>%&gt;%</span>
      <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='st'>"//item"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlToDataFrame.html'>xmlToDataFrame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"publish_date"</span> <span class='op'>=</span> <span class='va'>pubDate</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>publish_date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>publish_date</span>,
                                       format <span class='op'>=</span> <span class='st'>"%a, %d %b %Y %H:%M:%S %z"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>title_text <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove_all</a></span><span class='op'>(</span>
        <span class='va'>title</span>, <span class='st'>"&amp;\\w+;|&lt;[[:punct:]]*b&gt;"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>title_text <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove_all</a></span><span class='op'>(</span>
        <span class='va'>title_text</span>, <span class='st'>"[[:punct:]]*"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>description_text <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove_all</a></span><span class='op'>(</span>
        <span class='va'>description</span>,
        <span class='st'>"&amp;\\w+;|&lt;[[:punct:]]*b&gt;|[“”]"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='va'>searchUrl</span> <span class='op'>&lt;-</span> <span class='st'>"https://openapi.naver.com/v1/search/news.xml"</span>

  <span class='va'>query</span> <span class='op'>&lt;-</span> <span class='va'>query</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/Encoding.html'>enc2utf8</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/URLencode.html'>URLencode</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='va'>url</span> <span class='op'>&lt;-</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"{searchUrl}?query={query}&amp;display={chunk}&amp;start={chunk_no}&amp;sort={sort}"</span><span class='op'>)</span>

  <span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='va'>url</span> <span class='op'>%&gt;%</span>
    <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span>
      <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/add_headers.html'>add_headers</a></span><span class='op'>(</span>
        <span class='st'>"X-Naver-Client-Id"</span>     <span class='op'>=</span> <span class='va'>client_id</span>,
        <span class='st'>"X-Naver-Client-Secret"</span> <span class='op'>=</span> <span class='va'>client_secret</span>
      <span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/toString.html'>toString</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlTreeParse.html'>xmlParse</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='va'>total_count</span> <span class='op'>&lt;-</span> <span class='va'>doc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='st'>"//total"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlValue.html'>xmlValue</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>verbose</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"* 검색된 총 기사 건수는 {total_count}건입니다.\n\n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='op'>)</span>

    <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"  - ({chunk}/{min(total_count, max_record)})건 호출을 진행합니다.\n\n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='va'>search_list</span> <span class='op'>&lt;-</span> <span class='va'>doc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>get_list</span><span class='op'>(</span><span class='op'>)</span>

  <span class='va'>records</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>NROW</a></span><span class='op'>(</span><span class='va'>search_list</span><span class='op'>)</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='va'>do_done</span> <span class='op'>|</span> <span class='va'>records</span> <span class='op'>&gt;=</span> <span class='va'>total_count</span> <span class='op'>|</span> <span class='va'>records</span> <span class='op'>&gt;=</span> <span class='va'>max_record</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>search_list</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>total_count</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>total_count</span>, <span class='va'>max_record</span><span class='op'>)</span>

    <span class='va'>cnt</span> <span class='op'>&lt;-</span> <span class='va'>total_count</span> <span class='op'>%/%</span> <span class='va'>chunk</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>total_count</span> <span class='op'>%%</span> <span class='va'>chunk</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>cnt</span> <span class='op'>&lt;-</span> <span class='va'>cnt</span> <span class='op'>-</span> <span class='fl'>1</span>
    <span class='op'>}</span>

    <span class='va'>idx</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>cnt</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>

    <span class='va'>add_list</span> <span class='op'>&lt;-</span> <span class='va'>idx</span><span class='op'>[</span><span class='va'>idx</span> <span class='op'>&lt;=</span> <span class='fl'>1000</span><span class='op'>]</span> <span class='op'>%&gt;%</span>
      <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_df</a></span><span class='op'>(</span><span class='op'>{</span>
        <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
          <span class='kw'>if</span> <span class='op'>(</span><span class='va'>verbose</span><span class='op'>)</span> <span class='op'>{</span>
            <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"  - ({chunk * x}/{total_count})건 호출을 진행합니다.\n\n"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='op'>)</span>
          <span class='op'>}</span>

          <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span>
            <span class='st'>"{searchUrl}?query={query}&amp;display={chunk}&amp;start={x}&amp;sort={sort}"</span>
          <span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span>
              <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/add_headers.html'>add_headers</a></span><span class='op'>(</span>
                <span class='st'>"X-Naver-Client-Id"</span>     <span class='op'>=</span> <span class='va'>client_id</span>,
                <span class='st'>"X-Naver-Client-Secret"</span> <span class='op'>=</span> <span class='va'>client_secret</span>
              <span class='op'>)</span>
            <span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://rdrr.io/r/base/toString.html'>toString</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlTreeParse.html'>xmlParse</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>get_list</span><span class='op'>(</span><span class='op'>)</span>
        <span class='op'>}</span>
      <span class='op'>}</span><span class='op'>)</span>

    <span class='va'>search_list</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span>
        <span class='va'>add_list</span>
      <span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
</section>
<section id="trade_apt.r" class="panel-name panel">
<h3 class="panel-name">trade_apt.R</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#' 아파트 실거래 데이터 가져오기</span>
<span class='co'>#'</span>
<span class='co'>#' @description 공공데이터포털에서 REST open API로 아파트 실거래 데이터를 수집합니다.</span>
<span class='co'>#'</span>
<span class='co'>#' @details 공공데이터포털에서 발급받은 API 인증키는 개인이 발급받은 키를 사용하며,</span>
<span class='co'>#' 유출되어서는 안됩니다.</span>
<span class='co'>#'</span>
<span class='co'>#' @param auth_key character. 공공데이터포털에서 발급받은 API 인증키</span>
<span class='co'>#' @param LAWD_CD character. 지역코드. 각 지역별 코드 행정표준코드관리시스템</span>
<span class='co'>#' (www.code.go.kr)의 법정동코드 10자리 중 앞 5자리</span>
<span class='co'>#' @param DEAL_YMD character. 실거래 자료의 계약년월(6자리)</span>
<span class='co'>#' @param chunk_no integer. 페이지번호</span>
<span class='co'>#' @param chunk integer. 한 페이지 결과 수</span>
<span class='co'>#' @param do_done logical. 한번의 호출로 모든 조회 결과를 가져오지 못할 경우,</span>
<span class='co'>#' 추가로 호출해서 모든 결과를 가져올지의 여부</span>
<span class='co'>#'</span>
<span class='co'>#' @return data.frame</span>
<span class='co'>#' 변수 목록은 다음과 같음.:</span>
<span class='co'>#' \itemize{</span>
<span class='co'>#' \item LAWD_CD : character. 지역코드</span>
<span class='co'>#' \item DEAL_DATE : character. 거래일자</span>
<span class='co'>#' \item SERIAL : character. 일련번호</span>
<span class='co'>#' \item BUILD_NM : character. 아파트 이름</span>
<span class='co'>#' \item FLOOR : integer. 층</span>
<span class='co'>#' \item BUILD_YEAR : integer. 건축년도</span>
<span class='co'>#' \item AREA : numeric. 전용면적</span>
<span class='co'>#' \item AMOUNT : integer. 거래금액</span>
<span class='co'>#' \item ROAD_CD : character. 도로명코드</span>
<span class='co'>#' \item ROAD_NM : character. 도로명</span>
<span class='co'>#' \item BUILD_MAJOR : character. 도로명건물본번호코드</span>
<span class='co'>#' \item BUILD_MINOR : character. 도로명건물부번호코드</span>
<span class='co'>#' \item ROAD_SEQ : character. 도로명일련번호코드</span>
<span class='co'>#' \item BASEMENT_FLAG : character. 도로명지상지하코드</span>
<span class='co'>#' \item LAND_NO : character. 지번</span>
<span class='co'>#' \item DONG_NM : character. 법정동</span>
<span class='co'>#' \item DONG_MAJOR : character. 법정동본번코드</span>
<span class='co'>#' \item DONG_MINOR : character. 법정동부번코드</span>
<span class='co'>#' \item EUBMYNDONG_CD : character. 법정동읍면동코드</span>
<span class='co'>#' \item DONG_LAND_NO : character. 법정동지번코드</span>
<span class='co'>#' \item DEALER_ADDR : character. 중개사소재지</span>
<span class='co'>#' \item CANCEL_DEAL : character. 해제여부</span>
<span class='co'>#' \item CANCEL_DATE : character. 해제사유발생일</span>
<span class='co'>#' }</span>
<span class='co'>#'</span>
<span class='co'>#' @examples</span>
<span class='co'>#' \donttest{</span>
<span class='co'>#' # Your authorized API keys</span>
<span class='co'>#' auth_key &lt;- "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span>
<span class='co'>#'</span>
<span class='co'>#' result &lt;- trade_apt(auth_key, LAWD_CD = "11680", DEAL_YMD = "202104")</span>
<span class='co'>#' result &lt;- trade_apt(auth_key, LAWD_CD = "11680", DEAL_YMD = "202104", do_done = TRUE)</span>
<span class='co'>#'</span>
<span class='co'>#' }</span>
<span class='co'>#'</span>
<span class='co'>#' @import dplyr</span>
<span class='co'>#' @importFrom XML xmlParse getNodeSet xmlValue xmlToDataFrame</span>
<span class='co'>#' @importFrom stringr str_pad</span>
<span class='co'>#' @importFrom purrr map_df</span>
<span class='co'>#' @importFrom glue glue</span>
<span class='co'>#' @export</span>
<span class='va'>trade_apt</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>auth_key</span>, <span class='va'>LAWD_CD</span> <span class='op'>=</span> <span class='st'>"11110"</span>, <span class='va'>DEAL_YMD</span> <span class='op'>=</span> <span class='st'>"202112"</span>,
                      <span class='va'>chunk_no</span> <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>chunk</span> <span class='op'>=</span> <span class='fl'>400</span>, <span class='va'>do_done</span> <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

  <span class='va'>get_list</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>doc</span> <span class='op'>%&gt;%</span>
      <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='st'>"//item"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlToDataFrame.html'>xmlToDataFrame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>거래금액 <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>거래금액</span>, <span class='st'>","</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                   <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>DEAL_DATE <span class='op'>=</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"{년}-{str_pad(월, width = 2, pad = '0')}-{
                                  str_pad(일, width = 2, pad = '0')}"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>층 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>층</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>건축년도 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>건축년도</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>년</span>, <span class='op'>-</span><span class='va'>월</span>, <span class='op'>-</span><span class='va'>일</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='st'>"LAWD_CD"</span>       <span class='op'>=</span> <span class='va'>지역코드</span>,
             <span class='va'>DEAL_DATE</span>,
             <span class='st'>"SERIAL"</span>        <span class='op'>=</span> <span class='va'>일련번호</span>,
             <span class='st'>"DEAL_TYPE"</span>     <span class='op'>=</span> <span class='va'>거래유형</span>,
             <span class='st'>"BUILD_NM"</span>      <span class='op'>=</span> <span class='va'>아파트</span>,
             <span class='st'>"FLOOR"</span>         <span class='op'>=</span> <span class='va'>층</span>,
             <span class='st'>"BUILD_YEAR"</span>    <span class='op'>=</span> <span class='va'>건축년도</span>,
             <span class='st'>"AREA"</span>          <span class='op'>=</span> <span class='va'>전용면적</span>,
             <span class='st'>"AMOUNT"</span>        <span class='op'>=</span> <span class='va'>거래금액</span>,
             <span class='st'>"ROAD_CD"</span>       <span class='op'>=</span> <span class='va'>도로명코드</span>,
             <span class='st'>"ROAD_NM"</span>       <span class='op'>=</span> <span class='va'>도로명</span>,
             <span class='st'>"BUILD_MAJOR"</span>   <span class='op'>=</span> <span class='va'>도로명건물본번호코드</span>,
             <span class='st'>"BUILD_MINOR"</span>   <span class='op'>=</span> <span class='va'>도로명건물부번호코드</span>,
             <span class='st'>"ROAD_SEQ"</span>      <span class='op'>=</span> <span class='va'>도로명일련번호코드</span>,
             <span class='st'>"BASEMENT_FLAG"</span> <span class='op'>=</span> <span class='va'>도로명지상지하코드</span>,
             <span class='st'>"LAND_NO"</span>       <span class='op'>=</span> <span class='va'>지번</span>,
             <span class='st'>"DONG_NM"</span>       <span class='op'>=</span> <span class='va'>법정동</span>,
             <span class='st'>"DONG_MAJOR"</span>    <span class='op'>=</span> <span class='va'>법정동본번코드</span>,
             <span class='st'>"DONG_MINOR"</span>    <span class='op'>=</span> <span class='va'>법정동부번코드</span>,
             <span class='st'>"EUBMYNDONG_CD"</span> <span class='op'>=</span> <span class='va'>법정동읍면동코드</span>,
             <span class='st'>"DONG_LAND_NO"</span>  <span class='op'>=</span> <span class='va'>법정동지번코드</span>,
             <span class='st'>"DEALER_ADDR"</span>   <span class='op'>=</span> <span class='va'>중개사소재지</span>,
             <span class='st'>"CANCEL_DEAL"</span>   <span class='op'>=</span> <span class='va'>해제여부</span>,
             <span class='st'>"CANCEL_DATE"</span>   <span class='op'>=</span> <span class='va'>해제사유발생일</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='va'>api</span> <span class='op'>&lt;-</span> <span class='st'>"http://openapi.molit.go.kr/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcAptTradeDev"</span>
  <span class='va'>url</span> <span class='op'>&lt;-</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span>
    <span class='st'>"{api}?ServiceKey={auth_key}&amp;pageNo={chunk_no}&amp;numOfRows={chunk}&amp;LAWD_CD={LAWD_CD}&amp;DEAL_YMD={DEAL_YMD}"</span>
  <span class='op'>)</span>

  <span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlTreeParse.html'>xmlParse</a></span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span>

  <span class='va'>resultCode</span> <span class='op'>&lt;-</span> <span class='va'>doc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='st'>"//resultCode"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlValue.html'>xmlValue</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>resultCode</span> <span class='op'>!=</span> <span class='st'>"00"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>result_msg</span> <span class='op'>&lt;-</span> <span class='va'>doc</span> <span class='op'>%&gt;%</span>
      <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='st'>"//resultMsg"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlValue.html'>xmlValue</a></span><span class='op'>(</span><span class='op'>)</span>

    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='va'>result_msg</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='va'>total_count</span> <span class='op'>&lt;-</span> <span class='va'>doc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/getNodeSet.html'>getNodeSet</a></span><span class='op'>(</span><span class='st'>"//totalCount"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlValue.html'>xmlValue</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='va'>deal_list</span> <span class='op'>&lt;-</span> <span class='va'>doc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>get_list</span><span class='op'>(</span><span class='op'>)</span>

  <span class='va'>records</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>NROW</a></span><span class='op'>(</span><span class='va'>deal_list</span><span class='op'>)</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='va'>do_done</span> <span class='op'>|</span> <span class='va'>records</span> <span class='op'>&gt;=</span> <span class='va'>total_count</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>deal_list</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>cnt</span> <span class='op'>&lt;-</span> <span class='va'>total_count</span> <span class='op'>%/%</span> <span class='va'>chunk</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>total_count</span> <span class='op'>%%</span> <span class='va'>chunk</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>cnt</span> <span class='op'>&lt;-</span> <span class='va'>cnt</span> <span class='op'>-</span> <span class='fl'>1</span>
    <span class='op'>}</span>

    <span class='va'>add_list</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>cnt</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_df</a></span><span class='op'>(</span><span class='op'>{</span>
        <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
          <span class='va'>url</span> <span class='op'>&lt;-</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span>
            <span class='st'>"{api}?ServiceKey={auth_key}&amp;pageNo={x}&amp;numOfRows={chunk}&amp;LAWD_CD={LAWD_CD}&amp;DEAL_YMD={DEAL_YMD}"</span>
          <span class='op'>)</span>

          <span class='fu'>XML</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/XML/man/xmlTreeParse.html'>xmlParse</a></span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>get_list</span><span class='op'>(</span><span class='op'>)</span>
        <span class='op'>}</span>
      <span class='op'>}</span><span class='op'>)</span>

    <span class='va'>deal_list</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span>
        <span class='va'>add_list</span>
      <span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
</section>
</div>
<h2 id="패키지-관련-파일의-자동-생성">패키지 관련 파일의 자동 생성</h2>
<h3 id="roxygen2">roxygen2</h3>
<p><code>roxygen2</code> 패키지는 패키지를 개발할 때 help page를 기술하는 파일인 <code>Rd</code> 파일과 <code>NAMESPACE</code> 파일을 자동으로 작성해줍니다.</p>
<p>일반적으로 Rd 파일은 패키지 홈 디렉토리의 man 디렉토리에 <em>.Rd, </em>.rd 포맷의 이름으로 만듧니다. 그런데 <code>roxygen2</code> 패키지는 패키지를 정의하는 R 소스 파일에 roxygen 형식으로 스크립트를 작성하면, 자동으로 Rd 파일을 생성해줍니다.</p>
<p>NAMESPACE 파일에는 <strong>패키지에서 참조하는 다른 패키지나 패키지의 함수를 지정하는 import 정보</strong> 및 <strong>패키지의 함수에 접근할 수 있는 export 정보</strong>를 기술합니다.</p>
<p>다음은 roxygen 형식으로 스크립트를 작성한 R 소스 파일의 예제입다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#' 두 월도 사이의 개월수 구하기</span>
<span class='co'>#' @description 두개의 년월 사이에 몇 개의 개월이 포함되는 지를 구함</span>
<span class='co'>#' @param start_year integer. 시작하는 년도를 나타내는 수치값</span>
<span class='co'>#' @param start_month integer. 시작하는 월을 나타내는 수치값</span>
<span class='co'>#' @param end_year integer. 종료하는 년도를 나타내는 수치값</span>
<span class='co'>#' @param end_month integer. 종료하는 월을 나타내는 수치값</span>
<span class='co'>#' @return 개월수를 나타내는 수치 벡터</span>
<span class='co'>#' @author 유충현</span>
<span class='co'>#' Maintainer: 유충현 &lt;choonghyun.ryu@gmail.com&gt;</span>
<span class='co'>#' @seealso \code{\link{get_next_month}}, \code{\link{is_indate}}</span>
<span class='co'>#' @examples</span>
<span class='co'>#' get_month_length(2015, 3, 2017, 3)</span>
<span class='co'>#' @export</span>
<span class='va'>get_month_length</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>start_year</span>, <span class='va'>start_month</span>, <span class='va'>end_year</span>, <span class='va'>end_month</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>start_month</span> <span class='op'>&gt;</span> <span class='va'>end_month</span>, <span class='fl'>12</span> <span class='op'>+</span> <span class='va'>end_month</span> <span class='op'>-</span> <span class='va'>start_month</span> <span class='op'>+</span>
    <span class='op'>(</span><span class='va'>end_year</span> <span class='op'>-</span> <span class='va'>start_year</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>12</span> <span class='op'>+</span> <span class='fl'>1</span>, <span class='va'>end_month</span> <span class='op'>-</span> <span class='va'>start_month</span> <span class='op'>+</span>
    <span class='op'>(</span><span class='va'>end_year</span> <span class='op'>-</span> <span class='va'>start_year</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>12</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p><strong>roxygen 스크립트의 시작은 <code>#'</code>로 시작</strong>합니다. 즉, R 소스 파일에서 <code>#'</code>로 시작하는 라인은 roxygen2 패키지가 해석하는 라인입니다.</p>
<h3 id="roxygen2-태그">roxygen2 태그</h3>
<p>roxygen2의 대표적인 태그는 다음과 같습니다.:</p>
<ul>
<li><span class="citation" data-cites="title">@title</span> : Rd 파일의 \title 태그로 기술될 태그
<ul>
<li>함수의 타이틀을 기술</li>
<li><span class="citation" data-cites="title을">@title을</span> 기술하지 않으면, 첫 줄의 내용이 \title 태그로 기술됨</li>
</ul></li>
<li><span class="citation" data-cites="description">@description</span> : Rd 파일의 태그로 기술될 태그
<ul>
<li>함수의 상세 설명을 기술</li>
</ul></li>
<li><span class="citation" data-cites="param">@param</span> : Rd 파일의 태그 내의
태그로 기술될 태그
<ul>
<li>함수의 인수 이름과 그 내용을 기술</li>
</ul></li>
<li><span class="citation" data-cites="return">@return</span> : Rd 파일의 태그로 기술될 태그
<ul>
<li>함수가 반환하는 값에 대한 설명을 기술</li>
</ul></li>
<li><span class="citation" data-cites="author">@author</span> : Rd 파일의 \author 태그로 기술될 태그
<ul>
<li>함수 개발자 정보를 기술</li>
</ul></li>
<li><span class="citation" data-cites="seealso">@seealso</span> : Rd 파일의 태그로 기술될 태그
<ul>
<li>함께 알아두면 유용한 관련 함수를 기술</li>
</ul></li>
<li><span class="citation" data-cites="examples">@examples</span> : Rd 파일의 태그로 기술될 태그
<ul>
<li>함수의 사용 예제를 기술</li>
</ul></li>
<li><span class="citation" data-cites="export">@export</span> : NAMESPACE 파일의 export() 함수로 기술될 태그
<ul>
<li>NAMESPACE 파일에서의 export 정보를 기술할지의 여부를 지정</li>
<li>해당 태그를 기술할 경우만 export 정보를 기술한다.</li>
</ul></li>
</ul>
<h3 id="roxygen2-태그-기반-자동-생성">roxygen2 태그 기반 자동 생성</h3>
<p>roxygen2 패키지의 <strong><code>roxygenise()</code></strong> 함수는 R 소스 파일의 roxygen2 태그를 해석하여 도움말 파일인 Rd 파일과 NAMESPACE 파일을 생성합니다. 또한 DESCRIPTION 파일도 업데이트합니다.</p>
<p>다음 스크립트를 실행하면 R/misc.R 파일을 읽어서 Rd 파일과 NAMESPACE 파일을 생성하고, DESCRIPTION 파일을 업데이트 합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>roxygen2</span><span class='fu'>::</span><span class='fu'><a href='https://roxygen2.r-lib.org/reference/roxygenize.html'>roxygenise</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="rd-파일의-생성">Rd 파일의 생성</h4>
<p>roxygenise()의 실행으로, 앞에서 만든 “search_naver.R”과 “trade_apt.R” 파일의 roxygen2 태그는 도움말 파일을 만들어졌습니다. 이 두 개의 도움말 중에서 “search_naver.Rd”는 다음과 같습니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>% Generated by roxygen2<span class="sc">:</span> do not edit by hand</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>% Please edit documentation <span class="cf">in</span> R<span class="sc">/</span>search_naver.R</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>\name{search_naver}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>\alias{search_naver}</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>\title{네이버 뉴스 검색}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>\usage{</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">search_naver</span>(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chunk =</span> <span class="dv">100</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">chunk_no =</span> <span class="dv">1</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort =</span> <span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;sim&quot;</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">do_done =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_record =</span> 1000L,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">client_id =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">client_secret =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>\arguments{</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>\item{query}{character. 검색을 원하는 문자열}</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>\item{chunk}{integer. 검색 결과 출력 건수 지정 (<span class="dv">1</span><span class="sc">~</span><span class="dv">100</span>)}</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>\item{chunk_no}{integer. 검색 시작 위치로 최대 1000까지 가능}</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>\item{sort}{character. 정렬 옵션<span class="sc">:</span> <span class="fu">sim</span> (유사도순), <span class="fu">date</span> (날짜순)}</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>\item{do_done}{logical. 한번의 호출로 모든 조회 결과를 가져오지 못할 경우,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>추가로 호출해서 모든 결과를 가져올지의 여부}</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>\item{max_record}{integer. 최대 조회할 건수. 실제로 검색한 건수는 max_record와 정확히 일치하지 않을 수 있습니다.</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>chunk의 개수로 데이터를 수집하기 때문에 일반적인 경우에는 max_record보다 같거나  큰 chunk의 배수만큼 데이터를 가져옵니다.</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>do_done가 FALSE일 경우에는 적용되지 않습니다.}</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>\item{client_id}{character. 애플리케이션 등록 시 발급받은 Client ID}</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>\item{client_secret}{character. 애플리케이션 등록 시 발급받은 Client Secret}</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>\value{</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>data.frame</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>변수 목록은 다음과 같음.<span class="sc">:</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>\itemize{</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>\item title <span class="sc">:</span> character. 기사의 타이틀</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>\item originallink <span class="sc">:</span> character. 검색 결과 문서의 제공 언론사 하이퍼텍스트 link</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>\item link <span class="sc">:</span> character. 검색 결과 문서의 제공 네이버 하이퍼텍스트 link</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>\item description <span class="sc">:</span> character. 검색 결과 문서의 내용을 요약한 패시지 정보.</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>문서 전체의 내용은 link를 따라가면 읽을 수 있음. 패시지에서 검색어와 일치하는 부분은 태그로 감싸져 있음</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>\item publish_date <span class="sc">:</span> POSIXct. 검색 결과 문서가 네이버에 제공된 시간</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>\item title_text <span class="sc">:</span> character. 타이틀에서 HTML 태크를 제거한 텍스트</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>\item description_text <span class="sc">:</span> character. 요약한 패시지 정보에서 HTML 태크를 제거한 텍스트</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>\description{</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>네이버 뉴스 검색 결과를 출력해주는 REST API를 호출하여, 뉴스 정보를 검색합니다.</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>\details{</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>네이버에서 발급받은 Client ID, Client Secret는 개인이 발급받은 키를 사용하며,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>유출되어서는 안됩니다.</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>\examples{</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>\donttest{</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Your authorized API keys</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>client_id <span class="ot">&lt;-</span> <span class="st">&quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>client_secret <span class="ot">&lt;-</span> <span class="st">&quot;XXXXXXXXX&quot;</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>search_list <span class="ot">&lt;-</span> <span class="fu">search_naver</span>(</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;불평등&quot;</span>, <span class="at">client_id =</span> client_id, <span class="at">client_secret =</span> client_secret</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>search_list <span class="ot">&lt;-</span> <span class="fu">search_naver</span>(</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;불평등&quot;</span>, <span class="at">client_id =</span> client_id, <span class="at">client_secret =</span> client_secret,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">do_done =</span> <span class="cn">TRUE</span>, <span class="at">max_record =</span> <span class="dv">350</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>그리고 패키지가 Build되면 이 도움말은 다음과 같은 도움말을 제공하게 됩니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:help"></span>
<img src="img/help.png" alt="search_naver 함수의 도움말 화면" width="40%" />
<p class="caption">
Figure 6: search_naver 함수의 도움말 화면
</p>
</div>
</div>
<h4 id="namespace-파일의-생성">NAMESPACE 파일의 생성</h4>
<p>NAMESPACE 파일도 변경되었습니다.</p>
<p><span class="citation" data-cites="export">@export</span> 태그를 사용한 두 함수는 export()로, 그리고 참조하는 다른 패키지와 함수들은 import(), importFrom()로 기술되었습니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Generated by roxygen2: do not edit by hand</span>

<span class='fu'>export</span><span class='op'>(</span><span class='va'>search_naver</span><span class='op'>)</span>
<span class='fu'>export</span><span class='op'>(</span><span class='va'>trade_apt</span><span class='op'>)</span>
<span class='fu'>import</span><span class='op'>(</span><span class='va'>dplyr</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>XML</span>,<span class='va'>getNodeSet</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>XML</span>,<span class='va'>xmlParse</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>XML</span>,<span class='va'>xmlToDataFrame</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>XML</span>,<span class='va'>xmlValue</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>glue</span>,<span class='va'>glue</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>httr</span>,<span class='va'>GET</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>httr</span>,<span class='va'>add_headers</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>purrr</span>,<span class='va'>map_df</span><span class='op'>)</span>
<span class='fu'>importFrom</span><span class='op'>(</span><span class='va'>stringr</span>,<span class='va'>str_pad</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="r-데이터-생성">R 데이터 생성</h2>
<p>아파트 실거래 상세 조회를 위해서 법정동 코드가 필요합니다. 그래서 이 코드 정보를 패키지에 포함하려 합니다.</p>
<h3 id="r-데이터-파일-생성">R 데이터 파일 생성</h3>
<p>R 패키지에서 외부 파일을 넣는 디렉토리인 “inst”에 “meta”라는 디렉토리를 만든 후 법정동 코드 파일인 “법정동코드 전체자료.txt”을 복사해 넣은 뒤에 다음의 코드를 실행합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='va'>fname</span> <span class='op'>&lt;-</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"inst"</span>, <span class='st'>"meta"</span>, <span class='st'>"법정동코드 전체자료.txt"</span><span class='op'>)</span>
<span class='va'>legal_divisions</span> <span class='op'>&lt;-</span> <span class='va'>fname</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span><span class='op'>(</span>sep <span class='op'>=</span> <span class='st'>"\t"</span>, header <span class='op'>=</span> <span class='cn'>TRUE</span>, fileEncoding <span class='op'>=</span> <span class='st'>"cp949"</span>,
             col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DIVISION_ID"</span>, <span class='st'>"DIVISION_NM"</span>, <span class='st'>"MAINTAIN"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>DIVISION_ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>DIVISION_ID</span>, scientific <span class='op'>=</span> <span class='cn'>FALSE</span>, trim <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>MAINTAIN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
    <span class='va'>MAINTAIN</span> <span class='op'>==</span> <span class='st'>"존재"</span> <span class='op'>~</span> <span class='st'>"Y"</span>,
    <span class='va'>MAINTAIN</span> <span class='op'>==</span> <span class='st'>"폐지"</span> <span class='op'>~</span> <span class='st'>"N"</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>MEGA_CD <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>DIVISION_ID</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,
         MEGA_NM <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract</a></span><span class='op'>(</span><span class='va'>DIVISION_NM</span>, <span class='st'>"^[\\w]+"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>CTY_CD <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>DIVISION_ID</span>, <span class='fl'>1</span>, <span class='fl'>5</span><span class='op'>)</span>,
         CTY_NM <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract</a></span><span class='op'>(</span><span class='va'>DIVISION_NM</span>, <span class='st'>" [\\w]+"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
           <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='st'>"\\s"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ADMI_CD <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>DIVISION_ID</span>, <span class='fl'>1</span>, <span class='fl'>8</span><span class='op'>)</span>,
         ADMI_NM <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>DIVISION_NM</span>, <span class='st'>"^[\\w]+ [\\w]+ "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>DIVISION_ID</span>, <span class='st'>"000000$"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/save.html'>save</a></span><span class='op'>(</span><span class='va'>legal_divisions</span>, file <span class='op'>=</span> <span class='st'>"data/legal_divisions.rda"</span><span class='op'>)</span>


<span class='va'>db_name</span> <span class='op'>&lt;-</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"inst"</span>, <span class='st'>"meta"</span>, <span class='st'>"GISDB.sqlite"</span><span class='op'>)</span>

<span class='va'>con</span> <span class='op'>&lt;-</span> <span class='fu'>DBI</span><span class='fu'>::</span><span class='fu'><a href='https://dbi.r-dbi.org/reference/dbConnect.html'>dbConnect</a></span><span class='op'>(</span><span class='fu'>RSQLite</span><span class='fu'>::</span><span class='fu'><a href='https://rsqlite.r-dbi.org/reference/SQLite.html'>SQLite</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>db_name</span><span class='op'>)</span>
<span class='fu'>DBI</span><span class='fu'>::</span><span class='fu'><a href='https://dbi.r-dbi.org/reference/dbWriteTable.html'>dbWriteTable</a></span><span class='op'>(</span><span class='va'>con</span>, <span class='st'>"TB_LEGAL_DIVISIONS"</span>, <span class='va'>legal_divisions</span>, overwrite <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>DBI</span><span class='fu'>::</span><span class='fu'><a href='https://dbi.r-dbi.org/reference/dbDisconnect.html'>dbDisconnect</a></span><span class='op'>(</span><span class='va'>con</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>이 코드가 실행되면, “./inst/meta” 경로에 “법정동코드 전체자료.txt”, “GISDB.sqlite”가 위치하고 “./data” 경로에 “legal_divisions.rda” 파일이 위치하게 됩니다.</p>
<h3 id="r-데이터-도움말-파일-생성">R 데이터 도움말 파일 생성</h3>
<p>legal_divisons.R 파일에 도움말을 위한 roxygen2 태그를 기술하고, 앞에서 데이터를 만든 코드를 주석으로 보관합니다. 데이터의 도움말을 생성하는 roxygen2 태그는 함수의 도움말을 생성하는 것과 다소 차이가 있습니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#' 행정구역 코드 정보</span>
<span class='co'>#'</span>
<span class='co'>#' @description</span>
<span class='co'>#' 행정표준관리시스템의 법정동코드 전체자료로부터 추출한 광역시도,시군구, 읍면동 레벨의 코드 정보.</span>
<span class='co'>#'</span>
<span class='co'>#' @details</span>
<span class='co'>#' 공공데이터포털에서 Open API로 행정구역 관련 데이터를 수집할 때, 입력 파라미터로 조직 코드를 사용할 경우가 많습니다.</span>
<span class='co'>#' 이때 이 정보를 이용해서 원하는 지역의 정보를 수집할 수 있습니다.</span>
<span class='co'>#'</span>
<span class='co'>#' @format 45953 관측치와 9 변수를 갖는 data.frame. 다음과 같은 변수를 포함합니다.:</span>
<span class='co'>#' \describe{</span>
<span class='co'>#'   \item{DIVISION_ID}{charcter. 법정동 코드.}</span>
<span class='co'>#'   \item{DIVISION_NM}{charcter. 법정동 이름.}</span>
<span class='co'>#'   \item{MAINTAIN}{logical. 유지여부.}</span>
<span class='co'>#'   \item{MEGA_CD}{charcter. 광역시도 코드.}</span>
<span class='co'>#'   \item{MEGA_NM}{charcter. 광역시도 이름.}</span>
<span class='co'>#'   \item{CTY_CD}{charcter. 시군구 코드.}</span>
<span class='co'>#'   \item{CTY_NM}{charcter. 시군구 이름.}</span>
<span class='co'>#'   \item{ADMI_CD}{charcter. 읍면동 코드.}</span>
<span class='co'>#'   \item{ADMI_NM}{charcter. 읍면동 이름.}</span>
<span class='co'>#' }</span>
<span class='co'>#' @docType data</span>
<span class='co'>#' @keywords datasets</span>
<span class='co'>#' @name legal_divisions</span>
<span class='co'>#' @usage data(legal_divisions)</span>
<span class='co'>#' @source {</span>
<span class='co'>#' "행정표준관리시스템" &lt;https://www.code.go.kr/stdcodesrch/codeAllDownloadL.do&gt;</span>
<span class='co'>#' }</span>
<span class='cn'>NULL</span>

<span class='co'># library(dplyr)</span>
<span class='co'># fname &lt;- here::here("inst", "meta", "법정동코드 전체자료.txt")</span>
<span class='co'># legal_divisions &lt;- fname %&gt;%</span>
<span class='co'>#   read.table(sep = "\t", header = TRUE, fileEncoding = "cp949",</span>
<span class='co'>#              col.names = c("DIVISION_ID", "DIVISION_NM", "MAINTAIN")) %&gt;%</span>
<span class='co'>#   mutate(DIVISION_ID = format(DIVISION_ID, scientific = FALSE, trim = TRUE)) %&gt;%</span>
<span class='co'>#   mutate(MAINTAIN = case_when(</span>
<span class='co'>#     MAINTAIN == "존재" ~ "Y",</span>
<span class='co'>#     MAINTAIN == "폐지" ~ "N")</span>
<span class='co'>#   ) %&gt;%</span>
<span class='co'>#   mutate(MEGA_CD = substr(DIVISION_ID, 1, 2),</span>
<span class='co'>#          MEGA_NM = stringr::str_extract(DIVISION_NM, "^[\\w]+")) %&gt;%</span>
<span class='co'>#   mutate(CTY_CD = substr(DIVISION_ID, 1, 5),</span>
<span class='co'>#          CTY_NM = stringr::str_extract(DIVISION_NM, " [\\w]+") %&gt;%</span>
<span class='co'>#            stringr::str_remove("\\s")) %&gt;%</span>
<span class='co'>#   mutate(ADMI_CD = substr(DIVISION_ID, 1, 8),</span>
<span class='co'>#          ADMI_NM = stringr::str_remove(DIVISION_NM, "^[\\w]+ [\\w]+ ")) %&gt;%</span>
<span class='co'>#   filter(!stringr::str_detect(DIVISION_ID, "000000$"))</span>
<span class='co'>#</span>
<span class='co'># save(legal_divisions, file = "data/legal_divisions.rda")</span>
<span class='co'>#</span>
<span class='co'>#</span>
<span class='co'># db_name &lt;- here::here("inst", "meta", "GISDB.sqlite")</span>
<span class='co'>#</span>
<span class='co'># con &lt;- DBI::dbConnect(RSQLite::SQLite(), db_name)</span>
<span class='co'># DBI::dbWriteTable(con, "TB_LEGAL_DIVISIONS", legal_divisions, overwrite = TRUE)</span>
<span class='co'># DBI::dbDisconnect(con)</span>
</code></pre>
</div>
</div>
<h2 id="vignette-작성하기">vignette 작성하기</h2>
<h3 id="vignette-골격-생성하기">vignette 골격 생성하기</h3>
<p>usethis::use_vignette(“intro”, title = “introduce koscrap”) 명령어를 통해서 vignette 골격을 생성합니다. 이 명령어는 vignette의 타이틀이 “introduce koscrap”인 “intro.Rmd”라는 마크다운 문서 템플리트를 생성합니다. 또한 출력되는 메시지처럼 여러 작업을 수행합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> usethis<span class="sc">::</span><span class="fu">use_vignette</span>(<span class="st">&quot;intro&quot;</span>, <span class="at">title =</span> <span class="st">&quot;introduce koscrap&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>✓ Setting active project to <span class="st">&#39;/Users/choonghyunryu/Documents/01_Personal/00_bitr/01_packages/koscrap&#39;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;knitr&#39;</span> to Suggests field <span class="cf">in</span> DESCRIPTION</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>✓ Setting VignetteBuilder field <span class="cf">in</span> DESCRIPTION to <span class="st">&#39;knitr&#39;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;inst/doc&#39;</span> to <span class="st">&#39;.gitignore&#39;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>✓ Creating <span class="st">&#39;vignettes/&#39;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;*.html&#39;</span>, <span class="st">&#39;*.R&#39;</span> to <span class="st">&#39;vignettes/.gitignore&#39;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;rmarkdown&#39;</span> to Suggests field <span class="cf">in</span> DESCRIPTION</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>✓ Writing <span class="st">&#39;vignettes/intro.Rmd&#39;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>• Modify <span class="st">&#39;vignettes/intro.Rmd&#39;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span></code></pre></div>
</div>
<p>vignette 템플리트인 “intro.Rmd”은 다음과 같습니다.</p>
<pre><code>---
title: &quot;introduce koscrap&quot;
output: rmarkdown::html_vignette
vignette: &gt;
  %\VignetteIndexEntry{introduce koscrap}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = &quot;#&gt;&quot;
)
```

```{r setup}
library(koscrap)
```
</code></pre>
<h3 id="vignette-작성하기-1">vignette 작성하기</h3>
<p>템플리트를 토대로 해서 다음과 같은 vignette을 작성하였습니다. vignette에 명령어와 결과를 포함하여 작성한 이유는, API를 호출하기 위한 클라이언트 아이디, 보안키 등을 노출하지 않기 위함입니다. 만약 실행 코드만으로 vignette을 작성하려면, 클라이언트 아이디, 보안키 등의 노출되기 때문입니다.</p>
<pre><code>---
title: &quot;introduce koscrap&quot;
output: rmarkdown::html_vignette
vignette: &gt;
  %\VignetteIndexEntry{introduce koscrap}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



## koscrap에 대하여
koscrap(Korean Scraping)은 공공데이터포털의 아파트실거래 상세 내역과 NAVER의 뉴스검색 데이터를 수집하는 패키지입니다. REST 오픈 API를 이용해서 정해진 데이터를 수집할 수 있습니다.

## koscrap 기능
현재 구현된 koscrap의 기능을 다음과 같습니다.

* 공공데이터포털의 아파트실거래
  - trade_apt()
* NAVER의 뉴스검색 
  - search_naver()

## 공공데이터포털의 아파트실거래 예제
서울특별시 노원구의 2021년도 12월의 아파트 거래 내역을 수집합니다.

먼저 공공데이터포털에서 발급받은 서비스키를 기술합니다. 본 예제는 서비스키는 개인의 정보이므로 여기서는 임의의 문자로 형식만 표기합니다.

```{r, eval=FALSE}
library(&quot;koscrap&quot;)
library(&quot;dplyr&quot;)

auth_key &lt;- &quot;xxxxxxxxxxxxxxxxxxx&quot;
```

패키지에서 제공하는 법정동 코드 데이터인 `legal_divisions`로부터 노원구의 시군구 코드를 가져옵니다. 그리고 `trade_apt()`로 아파트거래정보를 수집합니다.

```{r, eval=FALSE}
LAWD_CD &lt;- legal_divisions %&gt;% 
  filter(CTY_NM %in% &quot;노원구&quot;) %&gt;% 
  select(CTY_CD) %&gt;% 
  filter(row_number() == 1) %&gt;% 
  pull()

nowon &lt;- trade_apt(auth_key, 
          LAWD_CD = LAWD_CD, 
          DEAL_YMD = &quot;202112&quot;)

glimpse(nowon)
#&gt; Rows: 59
#&gt; Columns: 24
#&gt; $ LAWD_CD       &lt;chr&gt; &quot;11350&quot;, &quot;11350&quot;, &quot;11350&quot;, &quot;11350&quot;, &quot;11350&quot;, &quot;11350&quot;, &quot;1…
#&gt; $ DEAL_DATE     &lt;glue&gt; &quot;2021-12-05&quot;, &quot;2021-12-06&quot;, &quot;2021-12-07&quot;, &quot;2021-12-10&quot;,…
#&gt; $ SERIAL        &lt;chr&gt; &quot;11350-149&quot;, &quot;11350-133&quot;, &quot;11350-150&quot;, &quot;11350-151&quot;, &quot;113…
#&gt; $ DEAL_TYPE     &lt;chr&gt; &quot;중개거래&quot;, &quot;중개거래&quot;, &quot;중개거래&quot;, &quot;직거래&quot;, &quot;중개거래&quot;…
#&gt; $ BUILD_NM      &lt;chr&gt; &quot;주공2&quot;, &quot;한진한화그랑빌&quot;, &quot;청백3&quot;, &quot;청백4&quot;, &quot;주공2&quot;, &quot;…
#&gt; $ FLOOR         &lt;int&gt; 4, 24, 13, 14, 12, 2, 15, 9, 9, 12, 14, 19, 15, 8, 16, 1…
#&gt; $ BUILD_YEAR    &lt;int&gt; 1992, 2002, 1998, 1998, 1992, 2000, 1992, 1987, 1994, 19…
#&gt; $ AREA          &lt;chr&gt; &quot;58.65&quot;, &quot;114.97&quot;, &quot;39.84&quot;, &quot;84.54&quot;, &quot;44.52&quot;, &quot;84.98&quot;, &quot;…
#&gt; $ AMOUNT        &lt;int&gt; 67500, 125000, 42500, 75000, 53800, 84500, 48000, 73600,…
#&gt; $ ROAD_CD       &lt;chr&gt; &quot;4130377&quot;, &quot;3109006&quot;, &quot;4130332&quot;, &quot;4130332&quot;, &quot;4130377&quot;, &quot;…
#&gt; $ ROAD_NM       &lt;chr&gt; &quot;초안산로1길&quot;, &quot;마들로&quot;, &quot;월계로45가길&quot;, &quot;월계로45가길&quot;,…
#&gt; $ BUILD_MAJOR   &lt;chr&gt; &quot;00018&quot;, &quot;00031&quot;, &quot;00089&quot;, &quot;00094&quot;, &quot;00018&quot;, &quot;00049&quot;, &quot;0…
#&gt; $ BUILD_MINOR   &lt;chr&gt; &quot;00000&quot;, &quot;00000&quot;, &quot;00000&quot;, &quot;00000&quot;, &quot;00000&quot;, &quot;00000&quot;, &quot;0…
#&gt; $ ROAD_SEQ      &lt;chr&gt; &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;0…
#&gt; $ BASEMENT_FLAG &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;…
#&gt; $ LAND_NO       &lt;chr&gt; &quot;556&quot;, &quot;18&quot;, &quot;780&quot;, &quot;781&quot;, &quot;556&quot;, &quot;929&quot;, &quot;556&quot;, &quot;12&quot;, &quot;7…
#&gt; $ DONG_NM       &lt;chr&gt; &quot; 월계동&quot;, &quot; 월계동&quot;, &quot; 월계동&quot;, &quot; 월계동&quot;, &quot; 월계동&quot;, &quot;…
#&gt; $ DONG_MAJOR    &lt;chr&gt; &quot;0556&quot;, &quot;0018&quot;, &quot;0780&quot;, &quot;0781&quot;, &quot;0556&quot;, &quot;0929&quot;, &quot;0556&quot;, …
#&gt; $ DONG_MINOR    &lt;chr&gt; &quot;0000&quot;, &quot;0000&quot;, &quot;0000&quot;, &quot;0000&quot;, &quot;0000&quot;, &quot;0000&quot;, &quot;0000&quot;, …
#&gt; $ EUBMYNDONG_CD &lt;chr&gt; &quot;10200&quot;, &quot;10200&quot;, &quot;10200&quot;, &quot;10200&quot;, &quot;10200&quot;, &quot;10200&quot;, &quot;1…
#&gt; $ DONG_LAND_NO  &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;…
#&gt; $ DEALER_ADDR   &lt;chr&gt; &quot;서울 강북구, 서울 성북구&quot;, &quot;서울 노원구&quot;, &quot;서울 노원구&quot;…
#&gt; $ CANCEL_DEAL   &lt;chr&gt; &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot;…
#&gt; $ CANCEL_DATE   &lt;chr&gt; &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot; &quot;, &quot;…
```

노원구에서 12월에 가장 고가로 매매된 아파트의 가격은 13억3천5백만원입니다. 그리고 매매건수는 상계동&gt;중계동&gt;공릉동 순입니다.

```{r, eval=FALSE}
nowon %&gt;% 
  summarise(max_price = max(AMOUNT))
#&gt;   max_price
#&gt; 1    133500

nowon %&gt;% 
  group_by(DONG_NM) %&gt;% 
  tally() %&gt;% 
  arrange(desc(n))
#&gt; # A tibble: 5 x 2
#&gt;   DONG_NM       n
#&gt;   &lt;chr&gt;     &lt;int&gt;
#&gt; 1 &quot; 상계동&quot;    27
#&gt; 2 &quot; 중계동&quot;    11
#&gt; 3 &quot; 공릉동&quot;    10
#&gt; 4 &quot; 월계동&quot;     8
#&gt; 5 &quot; 하계동&quot;     3
```
2006년 10월의 성동구의 매매 현황을 수집합니다. chunk의 값을 800으로 지정해서 765건을 수집했습니다. chunk의 기본값은 100으로 100건을 수집합니다.

```{r, eval=FALSE}
LAWD_CD &lt;- legal_divisions %&gt;% 
  filter(CTY_NM %in% &quot;성동구&quot;) %&gt;% 
  select(CTY_CD) %&gt;% 
  filter(row_number() == 1) %&gt;% 
  pull()

sungdong &lt;- trade_apt(auth_key, 
                      LAWD_CD = &quot;11200&quot;, 
                      DEAL_YMD = &quot;200610&quot;,
                      chunk = 800)

NROW(sungdong)
#&gt; [1] 765
```
  
## 네이버 뉴스 검색 예제
&quot;불평등&quot;이라는 키워드로 뉴스현황을 검색합니다.

사용자의 클라이언트 아이디와 보안키를 입력합니다. 사전에 네이버로부터 발급받아야 합니다.

```{r, eval=FALSE}
# Your authorized API keys
client_id &lt;- &quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;
client_secret &lt;- &quot;XXXXXXXXX&quot;
```

총 285,030건의 뉴스가 검색되었고 100건을 수집했습니다.

```{r, eval=FALSE}
inequality &lt;- search_naver(
  &quot;불평등&quot;, client_id = client_id, client_secret = client_secret
)
#&gt; * 검색된 총 기사 건수는 285036건입니다.
#&gt; - (100/285036)건 호출을 진행합니다.
```

1000건을 수집해 보겠습니다.

```{r, eval=FALSE}
inequality_1000 &lt;- search_naver(
  &quot;불평등&quot;, client_id = client_id, client_secret = client_secret,
  do_done = TRUE, max_record = 1000
)
#&gt; * 검색된 총 기사 건수는 285036건입니다.
#&gt; - (100/1000)건 호출을 진행합니다.
#&gt; - (200/1000)건 호출을 진행합니다.
#&gt; - (300/1000)건 호출을 진행합니다.
#&gt; - (400/1000)건 호출을 진행합니다.
#&gt; - (500/1000)건 호출을 진행합니다.
#&gt; - (600/1000)건 호출을 진행합니다.
#&gt; - (700/1000)건 호출을 진행합니다.
#&gt; - (800/1000)건 호출을 진행합니다.
#&gt; - (900/1000)건 호출을 진행합니다.
#&gt; - (1000/1000)건 호출을 진행합니다.
```

```{r, eval=FALSE}
head(inequality_1000)
#&gt;                                                                               title
#&gt; 1                                          이재명 후보, 문화예술 분야 6대 공약 발표
#&gt; 2                        조영수 이사장 “다른 사람의 관점에서 나를 성찰하게 하는 책”
#&gt; 3                [D:이슈] 장르물에 녹여낸 한국 사회…넷플릭스 오리지널 장점이자 한계
#&gt; 4              &amp;quot;기후위기 대응 64개국 중 59위…우물 안 K-대통령 돼선 안 돼&amp;quot;
#&gt; 5                       [지자체의 SR] 의정부시, 스마트시티 조성 탄력…국비 20억 확보
#&gt; 6 이재명 &amp;quot;미래산업 핵심은 재생에너지&amp;quot; 윤석열 &amp;quot;데이터·AI가 핵심&amp;quot;
#&gt;                                                                     originallink
#&gt; 1 http://www.cine21.com/news/view/?mag_id=99572&amp;utm_source=naver&amp;utm_medium=news
#&gt; 2                                         http://ch.yes24.com/Article/View/46942
#&gt; 3                          https://www.dailian.co.kr/news/view/1079823/?sc=Naver
#&gt; 4                                       https://www.nocutnews.co.kr/news/5700762
#&gt; 5                       http://www.srtimes.kr/news/articleView.html?idxno=107666
#&gt; 6                        https://www.eroun.net/news/articleView.html?idxno=27524
#&gt;                                                                                      link
#&gt; 1 https://news.naver.com/main/read.naver?mode=LSD&amp;mid=sec&amp;sid1=106&amp;oid=140&amp;aid=0000046515
#&gt; 2                                                  http://ch.yes24.com/Article/View/46942
#&gt; 3 https://news.naver.com/main/read.naver?mode=LSD&amp;mid=sec&amp;sid1=103&amp;oid=119&amp;aid=0002572721
#&gt; 4 https://news.naver.com/main/read.naver?mode=LSD&amp;mid=sec&amp;sid1=102&amp;oid=079&amp;aid=0003604477
#&gt; 5                                http://www.srtimes.kr/news/articleView.html?idxno=107666
#&gt; 6                                 https://www.eroun.net/news/articleView.html?idxno=27524
#&gt;                                                                                                                                                                                                                                                                         description
#&gt; 1                                                               방식의 영화 제작 지원을 확대하고, 애니메이션 투자펀드를 만들겠다는 것이다. 이 후보는 대기업의 독과점, 계약 관계의 &lt;b&gt;불평등&lt;/b&gt; 등을 시정해 문화예술 분야에 공정한 생태계를 조성할 수 있도록 노력하겠다고 강조했다.
#&gt; 2                                                               그리고 글로벌 각국이 갖는 &lt;b&gt;불평등&lt;/b&gt;에 대한 의문을 해소해주는 책이죠. 『수레바퀴 밑에서』 헤르만 헤세 저 수레바퀴 밑에서 헤르만 헤세 저 | 강태정 역 일신서적출판사 주인공 한스의 방황과 고뇌가 고등학생 시절... 
#&gt; 3                                                              나아가 극한 경쟁에 내몰린 현대인과 개인의 힘으로는 극복하기 힘든 &lt;b&gt;불평등&lt;/b&gt; 문제 등 작품에 녹아있는 메시지도 ‘오징어 게임’을 한층 새로운 데스 게임 드라마로 보이게 했다. 그러나 국내 시청자들은 ‘오징어 게임’... 
#&gt; 4                                                 그다음에 &lt;b&gt;불평등&lt;/b&gt; 여러 가지 쭉 나오는데 이 기후위기는 10위 안에도 못 들어갔습니다. ◇이윤상&amp;gt; 기후위기가... 물론 부동산, 일자리, &lt;b&gt;불평등&lt;/b&gt; 모두 중요하지만 기후위기는 모든 인류를 다 끝내는 거 아닙니까 그래서 이런... 
#&gt; 5                                                            사업 대상지 내 중랑천 약 4Km 구간에 다목적 AI 스마트 폴 및 스마트 게이트 등을 구축해 사물인터넷과 스마트 정보 체계를 연동하고 홍수 등 재난 위험 상황에 대한 즉각 대응체계 마련 및 정보 서비스 &lt;b&gt;불평등&lt;/b&gt; 환경을... 
#&gt; 6 尹 &amp;quot;핵폐기물 처리기술 고도화될 것&amp;quot; 李 &amp;quot;원전 정략대상 아냐&amp;quot; 심상정 &amp;quot;&lt;b&gt;불평등&lt;/b&gt; 해소·녹색전환&amp;quot; 안철수... 沈 &amp;quot;&lt;b&gt;불평등&lt;/b&gt; 해소·녹색전환&amp;quot; 安 &amp;quot;과학기술 주권국가&amp;quot; 강조 토론 중에는 각 후보의 일자리·성장 방안에 대한 철학도... 
#&gt;          publish_date
#&gt; 1 2022-02-04 15:17:00
#&gt; 2 2022-02-04 14:56:00
#&gt; 3 2022-02-04 14:49:00
#&gt; 4 2022-02-04 14:44:00
#&gt; 5 2022-02-04 14:42:00
#&gt; 6 2022-02-04 14:14:00
#&gt;                                                       title_text
#&gt; 1                        이재명 후보 문화예술 분야 6대 공약 발표
#&gt; 2       조영수 이사장 다른 사람의 관점에서 나를 성찰하게 하는 책
#&gt; 3 D이슈 장르물에 녹여낸 한국 사회넷플릭스 오리지널 장점이자 한계
#&gt; 4         기후위기 대응 64개국 중 59위우물 안 K대통령 돼선 안 돼
#&gt; 5        지자체의 SR 의정부시 스마트시티 조성 탄력국비 20억 확보
#&gt; 6       이재명 미래산업 핵심은 재생에너지 윤석열 데이터AI가 핵심
#&gt;                                                                                                                                                                                                  description_text
#&gt; 1    방식의 영화 제작 지원을 확대하고, 애니메이션 투자펀드를 만들겠다는 것이다. 이 후보는 대기업의 독과점, 계약 관계의 불평등 등을 시정해 문화예술 분야에 공정한 생태계를 조성할 수 있도록 노력하겠다고 강조했다.
#&gt; 2    그리고 글로벌 각국이 갖는 불평등에 대한 의문을 해소해주는 책이죠. 『수레바퀴 밑에서』 헤르만 헤세 저 수레바퀴 밑에서 헤르만 헤세 저 | 강태정 역 일신서적출판사 주인공 한스의 방황과 고뇌가 고등학생 시절... 
#&gt; 3   나아가 극한 경쟁에 내몰린 현대인과 개인의 힘으로는 극복하기 힘든 불평등 문제 등 작품에 녹아있는 메시지도 ‘오징어 게임’을 한층 새로운 데스 게임 드라마로 보이게 했다. 그러나 국내 시청자들은 ‘오징어 게임’... 
#&gt; 4 그다음에 불평등 여러 가지 쭉 나오는데 이 기후위기는 10위 안에도 못 들어갔습니다. ◇이윤상 기후위기가... 물론 부동산, 일자리, 불평등 모두 중요하지만 기후위기는 모든 인류를 다 끝내는 거 아닙니까 그래서 이런... 
#&gt; 5 사업 대상지 내 중랑천 약 4Km 구간에 다목적 AI 스마트 폴 및 스마트 게이트 등을 구축해 사물인터넷과 스마트 정보 체계를 연동하고 홍수 등 재난 위험 상황에 대한 즉각 대응체계 마련 및 정보 서비스 불평등 환경을... 
#&gt; 6         尹 핵폐기물 처리기술 고도화될 것 李 원전 정략대상 아냐 심상정 불평등 해소·녹색전환 안철수... 沈 불평등 해소·녹색전환 安 과학기술 주권국가 강조 토론 중에는 각 후보의 일자리·성장 방안에 대한 철학도...
```</code></pre>
<h3 id="vignette-빌드하기">vignette 빌드하기</h3>
<p>devtools::build_vignettes() 명령어를 통해서 vignette을 빌드합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">build_vignettes</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Building koscrap vignettes</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span> re<span class="sc">-</span>building ‘intro.Rmd’ using rmarkdown</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span> finished re<span class="sc">-</span>building ‘intro.Rmd’</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>✓ Creating <span class="st">&#39;doc/&#39;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;^doc$&#39;</span> to <span class="st">&#39;.Rbuildignore&#39;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;doc&#39;</span> to <span class="st">&#39;.gitignore&#39;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>Moving intro.html, intro.R to doc<span class="sc">/</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>Copying intro.Rmd to doc<span class="sc">/</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>✓ Creating <span class="st">&#39;Meta/&#39;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;^Meta$&#39;</span> to <span class="st">&#39;.Rbuildignore&#39;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>✓ Adding <span class="st">&#39;Meta&#39;</span> to <span class="st">&#39;.gitignore&#39;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>Building vignette index</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span></code></pre></div>
</div>
<p>“Meta” 디렉토리는 vignette에 대한 메타정보를 포함하고 있습니다.</p>
<p><strong>빌드 후 생성된 “doc” 리렉토리는 “inst” 디렉토리 하위 디렉토리로 이동시켜야 합니다.</strong></p>
<h2 id="koscrap-패키지-설치하기">koscrap 패키지 설치하기</h2>
<p>이제 R패키가 얼추 만들어졌습니다. 마지막으로 패키지를 빌드하는 일만 남았습니다.</p>
<h3 id="r-패키지-설치하기">R 패키지 설치하기</h3>
<p>패키지를 설치하기 위해서 <strong>RStudio의 “build 탭 메뉴”의 “Install and Restart”를 사용</strong>합니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:r-build"></span>
<img src="img/build.png" alt="R 패키지 설치" width="40%" />
<p class="caption">
Figure 7: R 패키지 설치
</p>
</div>
</div>
<p>R 패키지 설치하는 과정이 집행된 후, 정상적으로 패키지가 만들어지면 자동적으로 콘솔 화면에서 library() 함수로 패키지를 로딩합니다.</p>
<h2 id="koscrap-패키지-사용하기">koscrap 패키지 사용하기</h2>
<p>koscrap 패키지의 도움말을 선택하면, 다음과 같은 화면을 만나게 됩니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:koscrap-doc"></span>
<img src="img/koscrap_doc.png" alt="koscrap 도움말 홈페이지" width="40%" />
<p class="caption">
Figure 8: koscrap 도움말 홈페이지
</p>
</div>
</div>
<p>다음 명령어를 입력하면 vignette 문서를 볼 수 있습니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/vignette.html'>vignette</a></span><span class='op'>(</span><span class='st'>"intro"</span>, package <span class='op'>=</span> <span class='st'>"koscrap"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:koscrap-vignette"></span>
<img src="img/koscrap_vignette.png" alt="koscrap vignette 화면" width="40%" />
<p class="caption">
Figure 9: koscrap vignette 화면
</p>
</div>
</div>
<p>공공데이터포털의 아파트 실거래 상세조회를 수행해 봅니다.</p>
<p>먼저 사용자의 서비스키를 입력합니다. 여기서는 서비스키의 보안 유지를 위해서 임의의 문자로 채워 넣었습니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'>"koscrap"</span><span class='op'>)</span>
<span class='va'>auth_key</span> <span class='op'>&lt;-</span> <span class='st'>"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
</code></pre>
</div>
</div>
<p>2020년 6월 지역코드가 “11290”인 곳의 거래 정보를 가져옵니다. <code>chunk</code>가 1000이므로 한번 호출에 1000건 이내의 정보를 가져옵니다. 물론 해당 지역의 거래건수 내에서 가져오게 됩니다. <code>do_done</code>이 TRUE인 의미는 만약 해당 지역의 해당원 거래량이 <code>chunk</code>에서 지정한 건수보다 클 경우에, 함수 내부적으로 추가 호출하여 전 건을 가져오라는 의미입니다.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">trade_apt</span>(auth_key, <span class="at">LAWD_CD =</span> <span class="st">&quot;11290&quot;</span>, <span class="at">DEAL_YMD =</span> <span class="st">&quot;202006&quot;</span>, <span class="at">chunk =</span> <span class="dv">1000</span>, <span class="at">do_done =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(result)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  LAWD_CD  DEAL_DATE   SERIAL DEAL_TYPE BUILD_NM FLOOR BUILD_YEAR   AREA AMOUNT ROAD_CD      ROAD_NM</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">11290</span> <span class="dv">2020-06-01</span>  <span class="dv">11290-4</span>               성북     <span class="dv">3</span>       <span class="dv">1971</span>  <span class="fl">37.36</span>  <span class="dv">17000</span> <span class="dv">4121350</span>   성북로31길</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">11290</span> <span class="dv">2020-06-03</span>  <span class="dv">11290-4</span>               성북     <span class="dv">1</span>       <span class="dv">1971</span>  <span class="fl">37.36</span>  <span class="dv">14500</span> <span class="dv">4121350</span>   성북로31길</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">11290</span> <span class="dv">2020-06-11</span>  <span class="dv">11290-4</span>               성북     <span class="dv">2</span>       <span class="dv">1971</span>  <span class="fl">37.36</span>  <span class="dv">15000</span> <span class="dv">4121350</span>   성북로31길</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">11290</span> <span class="dv">2020-06-15</span> <span class="dv">11290-11</span>           성북좋은     <span class="dv">5</span>       <span class="dv">2002</span> <span class="fl">113.54</span>  <span class="dv">80000</span> <span class="dv">4121353</span>  성북로6가길</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">11290</span> <span class="dv">2020-06-18</span>  <span class="dv">11290-4</span>               성북     <span class="dv">1</span>       <span class="dv">1971</span>  <span class="fl">37.36</span>  <span class="dv">16000</span> <span class="dv">4121350</span>   성북로31길</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">11290</span> <span class="dv">2020-06-22</span>  <span class="dv">11290-8</span>               주암     <span class="dv">3</span>       <span class="dv">1972</span>  <span class="fl">48.73</span>  <span class="dv">23000</span> <span class="dv">4121349</span> 성북로31가길</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  BUILD_MAJOR BUILD_MINOR ROAD_SEQ BASEMENT_FLAG LAND_NO DONG_NM DONG_MAJOR DONG_MINOR EUBMYNDONG_CD</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">00040</span>       <span class="dv">00012</span>       <span class="dv">01</span>             <span class="dv">0</span>   <span class="dv">348-3</span>  성북동       <span class="dv">0348</span>       <span class="dv">0003</span>         <span class="dv">10100</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">00040</span>       <span class="dv">00012</span>       <span class="dv">01</span>             <span class="dv">0</span>   <span class="dv">348-3</span>  성북동       <span class="dv">0348</span>       <span class="dv">0003</span>         <span class="dv">10100</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">00040</span>       <span class="dv">00012</span>       <span class="dv">01</span>             <span class="dv">0</span>   <span class="dv">348-3</span>  성북동       <span class="dv">0348</span>       <span class="dv">0003</span>         <span class="dv">10100</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">00023</span>       <span class="dv">00000</span>       <span class="dv">01</span>             <span class="dv">0</span>  <span class="dv">179-96</span>  성북동       <span class="dv">0179</span>       <span class="dv">0096</span>         <span class="dv">10100</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>       <span class="dv">00040</span>       <span class="dv">00012</span>       <span class="dv">01</span>             <span class="dv">0</span>   <span class="dv">348-3</span>  성북동       <span class="dv">0348</span>       <span class="dv">0003</span>         <span class="dv">10100</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>       <span class="dv">00005</span>       <span class="dv">00000</span>       <span class="dv">01</span>             <span class="dv">0</span>     <span class="dv">286</span>  성북동       <span class="dv">0286</span>       <span class="dv">0000</span>         <span class="dv">10100</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  DONG_LAND_NO DEALER_ADDR CANCEL_DEAL CANCEL_DATE</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>            <span class="dv">1</span>                                    </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>            <span class="dv">1</span>                                    </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>            <span class="dv">1</span>                                    </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>            <span class="dv">1</span>                                    </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>            <span class="dv">1</span>                                    </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>            <span class="dv">1</span>                                     </span></code></pre></div>
</div>
<p>이상으로 koscrap 패키지의 간단한 사용을 통해서 패키지가 이상없이 만들어졌음을 파악했습니다.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>소품(Vignettes)은 비네트라고 발음합니다. 패키지의 기능을 소개하는 짧은 문서를 의미합니다. 함수의 도움말보다는 규모가 큽니다.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<div class="distill-site-nav distill-site-footer">
<!--Created by bitR.
<br>-->
Copyright 2022. <a href="https://choonghyunryu.github.io/about.html" target="_blank">Choonghyun Ryu. All rights reserved.</a>
</div>
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">유충현 (2022, Feb. 5). 애플리케이션 서버 구축을 위한 R 워크샾: R 패키지 개발하기. Retrieved from https://choonghyunryu.github.io/workshop_lecture/develop_package</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@misc{유충현2022r,
  author = {유충현, },
  title = {애플리케이션 서버 구축을 위한 R 워크샾: R 패키지 개발하기},
  url = {https://choonghyunryu.github.io/workshop_lecture/develop_package},
  year = {2022}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
